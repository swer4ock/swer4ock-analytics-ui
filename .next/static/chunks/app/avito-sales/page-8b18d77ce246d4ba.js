(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{525:function(e,t,o){Promise.resolve().then(o.bind(o,7178))},7178:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return r}});var n=o(7437),i=o(2265),l=o(4923);function r(){var e,t,o,r,d,s,c,a,x,g;let[h,p]=(0,i.useState)(null),[f,u]=(0,i.useState)(null),[y,b]=(0,i.useState)(null),[v,j]=(0,i.useState)(null),[m,_]=(0,i.useState)(null),[S,C]=(0,i.useState)("all");(0,i.useEffect)(()=>{let e=!0;return(async()=>{try{let t="all"===S?{}:{p_company:S},[o,n,i,r]=await Promise.all([(0,l.WW)("get_avito_sales_summary",Object.keys(t).length?t:void 0),(0,l.WW)("get_avito_top_cities_sales",{p_limit:10,...t}),(0,l.WW)("get_avito_categories_performance",{p_limit:10,...t}),(0,l.WW)("get_avito_sales_trends",{p_days:7,...t})]);if(!e)return;p(o),u(n),b(i),j(r)}catch(t){if(console.error("Avito Sales load error:",t),!e)return;_(String((null==t?void 0:t.message)||t)),p([]),u([]),b([]),j([])}})(),()=>{e=!1}},[S]);let W=null==h?void 0:h[0];return(0,n.jsxs)("main",{style:{padding:"24px",maxWidth:1400,margin:"0 auto",fontFamily:"system-ui, sans-serif"},children:[(0,n.jsxs)("div",{style:{marginBottom:32},children:[(0,n.jsx)("h1",{style:{color:"#2c3e50",marginBottom:8},children:"\uD83D\uDCCA Avito Продажи - Дашборд"}),(0,n.jsx)("p",{style:{fontSize:"16px",color:"#6c757d",marginBottom:24},children:"Аналитическая панель продаж Avito | IT отдел CRM"}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[(0,n.jsx)("label",{htmlFor:"company",style:{fontSize:14,color:"#444"},children:"Компания:"}),(0,n.jsx)("select",{id:"company",value:S,onChange:e=>C(e.target.value),style:{padding:"6px 10px",border:"1px solid #e1e1e1",borderRadius:6},children:[{value:"all",label:"Все компании"},{value:"seltka",label:"Сэлтка (Кирилл)"},{value:"iltech",label:"Ильтех (Ильнур)"},{value:"mituroom",label:"mituroom (Артем)"}].map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(null===h||null===f||null===y||null===v)&&(0,n.jsx)("div",{style:{padding:16,color:"#6c757d"},children:"Загрузка данных…"}),m&&(0,n.jsxs)("div",{style:{padding:16,color:"#721c24",background:"#f8d7da",border:"1px solid #f5c6cb",borderRadius:8},children:["Ошибка загрузки: ",m]})]}),(0,n.jsxs)("section",{style:{marginBottom:32},children:[(0,n.jsx)("h2",{style:{color:"#28a745",marginBottom:20},children:"\uD83C\uDFAF Ключевые показатели продаж"}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:16,marginBottom:24},children:[(0,n.jsxs)("div",{style:{padding:24,backgroundColor:"#e7f3ff",borderRadius:12,border:"1px solid #b8daff",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,n.jsx)("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#0056b3",marginBottom:8},children:null!==(r=null==W?void 0:null===(e=W.total_ads)||void 0===e?void 0:e.toLocaleString())&&void 0!==r?r:"—"}),(0,n.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#0056b3",marginBottom:4},children:"ОБЪЯВЛЕНИЙ"}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#6c757d"},children:"Всего в системе"})]}),(0,n.jsxs)("div",{style:{padding:24,backgroundColor:"#fff3cd",borderRadius:12,border:"1px solid #ffeaa7",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,n.jsx)("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#856404",marginBottom:8},children:null!==(d=null==W?void 0:null===(t=W.total_views)||void 0===t?void 0:t.toLocaleString())&&void 0!==d?d:"—"}),(0,n.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#856404",marginBottom:4},children:"ПРОСМОТРОВ"}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#6c757d"},children:"Общий трафик"})]}),(0,n.jsxs)("div",{style:{padding:24,backgroundColor:"#d4edda",borderRadius:12,border:"1px solid #c3e6cb",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,n.jsx)("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#155724",marginBottom:8},children:null!==(s=null==W?void 0:null===(o=W.total_contacts)||void 0===o?void 0:o.toLocaleString())&&void 0!==s?s:"—"}),(0,n.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#155724",marginBottom:4},children:"КОНТАКТОВ"}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#6c757d"},children:"Реальные лиды"})]}),(0,n.jsxs)("div",{style:{padding:24,backgroundColor:"#f8d7da",borderRadius:12,border:"1px solid #f5c6cb",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,n.jsx)("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#721c24",marginBottom:8},children:(null==W?void 0:W.avg_conversion)?"".concat(W.avg_conversion.toFixed(1),"%"):"—"}),(0,n.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#721c24",marginBottom:4},children:"КОНВЕРСИЯ"}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#6c757d"},children:"Просмотры → Контакты"})]}),(0,n.jsxs)("div",{style:{padding:24,backgroundColor:"#e2e3e5",borderRadius:12,border:"1px solid #d6d8db",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,n.jsxs)("div",{style:{fontSize:"28px",fontWeight:"bold",color:"#383d41",marginBottom:8},children:[(null!==(c=null==W?void 0:W.total_revenue)&&void 0!==c?c:0).toLocaleString()," ₽"]}),(0,n.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#383d41",marginBottom:4},children:"ВЫРУЧКА"}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#6c757d"},children:"Суммарная стоимость"})]})]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24,marginBottom:32},children:[(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{style:{color:"#6f42c1",marginBottom:20},children:"\uD83C\uDFD9️ Топ городов по продажам"}),(0,n.jsx)("div",{style:{border:"1px solid #e9ecef",borderRadius:12,overflow:"hidden",backgroundColor:"white",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,n.jsx)("thead",{style:{backgroundColor:"#f8f9fa"},children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{padding:16,textAlign:"left",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Город"}),(0,n.jsx)("th",{style:{padding:16,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Объявлений"}),(0,n.jsx)("th",{style:{padding:16,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Просмотры"}),(0,n.jsx)("th",{style:{padding:16,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Контакты"}),(0,n.jsx)("th",{style:{padding:16,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Конверсия"})]})}),(0,n.jsx)("tbody",{children:f&&0!==f.length?f.map((e,t)=>(0,n.jsxs)("tr",{style:{borderBottom:"1px solid #f1f3f4",backgroundColor:t%2==0?"white":"#fafbfc"},children:[(0,n.jsx)("td",{style:{padding:16,fontWeight:"600",color:"#2c3e50"},children:e.city}),(0,n.jsx)("td",{style:{padding:16,textAlign:"center",fontSize:"16px",fontWeight:"600"},children:e.ads_count}),(0,n.jsx)("td",{style:{padding:16,textAlign:"center"},children:e.total_views.toLocaleString()}),(0,n.jsx)("td",{style:{padding:16,textAlign:"center",fontSize:"16px",fontWeight:"600"},children:e.total_contacts}),(0,n.jsx)("td",{style:{padding:16,textAlign:"center"},children:(0,n.jsxs)("span",{style:{padding:"4px 8px",borderRadius:12,fontSize:"12px",fontWeight:"600",backgroundColor:e.conversion_rate>=5?"#d4edda":e.conversion_rate>=2?"#fff3cd":"#f8d7da",color:e.conversion_rate>=5?"#155724":e.conversion_rate>=2?"#856404":"#721c24"},children:[e.conversion_rate,"%"]})})]},t)):(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:5,style:{padding:32,textAlign:"center",color:"#888"},children:"Нет данных"})})})]})})]}),(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{style:{color:"#fd7e14",marginBottom:20},children:"\uD83D\uDCC2 Эффективность категорий"}),(0,n.jsx)("div",{style:{border:"1px solid #e9ecef",borderRadius:12,overflow:"hidden",backgroundColor:"white",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,n.jsx)("thead",{style:{backgroundColor:"#f8f9fa"},children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{padding:12,textAlign:"left",borderBottom:"2px solid #e9ecef",fontWeight:"600",fontSize:"14px"},children:"Категория"}),(0,n.jsx)("th",{style:{padding:12,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600",fontSize:"14px"},children:"Объявлений"}),(0,n.jsx)("th",{style:{padding:12,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600",fontSize:"14px"},children:"Контакты"}),(0,n.jsx)("th",{style:{padding:12,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600",fontSize:"14px"},children:"Конверсия"})]})}),(0,n.jsx)("tbody",{children:y&&0!==y.length?y.map((e,t)=>(0,n.jsxs)("tr",{style:{borderBottom:"1px solid #f1f3f4",backgroundColor:t%2==0?"white":"#fafbfc"},children:[(0,n.jsx)("td",{style:{padding:12,fontWeight:"600",color:"#2c3e50",fontSize:"14px"},children:e.category}),(0,n.jsx)("td",{style:{padding:12,textAlign:"center",fontSize:"14px",fontWeight:"600"},children:e.ads_count}),(0,n.jsx)("td",{style:{padding:12,textAlign:"center",fontSize:"14px",fontWeight:"600"},children:e.total_contacts}),(0,n.jsx)("td",{style:{padding:12,textAlign:"center"},children:(0,n.jsxs)("span",{style:{padding:"2px 6px",borderRadius:8,fontSize:"12px",fontWeight:"600",backgroundColor:e.conversion_rate>=3?"#d4edda":e.conversion_rate>=1?"#fff3cd":"#f8d7da",color:e.conversion_rate>=3?"#155724":e.conversion_rate>=1?"#856404":"#721c24"},children:[e.conversion_rate,"%"]})})]},t)):(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:4,style:{padding:32,textAlign:"center",color:"#888"},children:"Нет данных"})})})]})})]})]}),v&&v.length>0&&(0,n.jsxs)("section",{style:{marginBottom:32},children:[(0,n.jsx)("h2",{style:{color:"#20c997",marginBottom:20},children:"\uD83D\uDCC8 Тренды продаж (последние 7 дней)"}),(0,n.jsx)("div",{style:{border:"1px solid #e9ecef",borderRadius:12,overflow:"hidden",backgroundColor:"white",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,n.jsx)("thead",{style:{backgroundColor:"#f8f9fa"},children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{padding:12,textAlign:"left",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Дата"}),(0,n.jsx)("th",{style:{padding:12,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Объявлений"}),(0,n.jsx)("th",{style:{padding:12,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Просмотры"}),(0,n.jsx)("th",{style:{padding:12,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Контакты"}),(0,n.jsx)("th",{style:{padding:12,textAlign:"center",borderBottom:"2px solid #e9ecef",fontWeight:"600"},children:"Конверсия"})]})}),(0,n.jsx)("tbody",{children:v.map((e,t)=>(0,n.jsxs)("tr",{style:{borderBottom:"1px solid #f1f3f4",backgroundColor:t%2==0?"white":"#fafbfc"},children:[(0,n.jsx)("td",{style:{padding:12,fontWeight:"600",color:"#2c3e50"},children:new Date(e.report_date).toLocaleDateString("ru-RU")}),(0,n.jsx)("td",{style:{padding:12,textAlign:"center"},children:e.total_ads}),(0,n.jsx)("td",{style:{padding:12,textAlign:"center"},children:e.total_views.toLocaleString()}),(0,n.jsx)("td",{style:{padding:12,textAlign:"center",fontWeight:"600"},children:e.total_contacts}),(0,n.jsx)("td",{style:{padding:12,textAlign:"center"},children:e.avg_conversion?"".concat(e.avg_conversion.toFixed(1),"%"):"—"})]},t))})]})})]}),(0,n.jsxs)("footer",{style:{padding:24,backgroundColor:"#2c3e50",color:"white",borderRadius:12,textAlign:"center"},children:[(0,n.jsx)("h3",{style:{marginBottom:12},children:"\uD83D\uDE80 Avito Продажи - Аналитический Дашборд"}),(0,n.jsx)("p",{style:{marginBottom:16,opacity:.8},children:"IT отдел CRM | Frontend разработчик | Supabase + Vercel"}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[(0,n.jsxs)("span",{style:{padding:"6px 12px",backgroundColor:"#34495e",borderRadius:16,fontSize:"12px"},children:["\uD83D\uDCCA ",null!==(a=null==f?void 0:f.length)&&void 0!==a?a:0," городов"]}),(0,n.jsxs)("span",{style:{padding:"6px 12px",backgroundColor:"#34495e",borderRadius:16,fontSize:"12px"},children:["\uD83D\uDCC2 ",null!==(x=null==y?void 0:y.length)&&void 0!==x?x:0," категорий"]}),(0,n.jsxs)("span",{style:{padding:"6px 12px",backgroundColor:"#34495e",borderRadius:16,fontSize:"12px"},children:["\uD83D\uDCC8 ",null!==(g=null==v?void 0:v.length)&&void 0!==g?g:0," дней трендов"]}),(0,n.jsx)("span",{style:{padding:"6px 12px",backgroundColor:"#34495e",borderRadius:16,fontSize:"12px"},children:"⚡ Real-time данные"})]}),(0,n.jsxs)("div",{style:{marginTop:16,fontSize:"12px",opacity:.6},children:["Обновлено: ",(null==W?void 0:W.refreshed_at)?new Date(W.refreshed_at).toLocaleString("ru-RU"):"—"]})]})]})}},4923:function(e,t,o){"use strict";async function n(e,t){let o="".concat("https://uumrjikuqewlakczbnbs.supabase.co","/rest/v1/rpc/").concat(e),n="sb_publishable_sfsDkZToPxhGJC8-WdwoiQ_ZMNTcW6m",i=await fetch(o,{method:"POST",headers:{apikey:n,Authorization:"Bearer ".concat(n),"Content-Type":"application/json",Prefer:"count=none"},body:t?JSON.stringify(t):"{}",next:{revalidate:0},cache:"no-store"});if(!i.ok){let t=await i.text(),o=Error("RPC ".concat(e," failed: ").concat(i.status," ").concat(t));throw o.status=i.status,o}return i.json()}async function i(e,t){let o=async e=>{try{return await n(e,t)}catch(e){throw e}};try{return await o("".concat(e,"_v1"))}catch(r){var i;let t=String(null!==(i=null==r?void 0:r.message)&&void 0!==i?i:r),n=null==r?void 0:r.status,l=t.includes("PGRST203")||t.includes("Could not choose the best candidate function");if(404===n||405===n||l)return await o(e);throw r}}async function l(e){return i("get_avito_cpl_by_strategy",e)}async function r(e){return i("get_avito_top_cities_sales",e)}async function d(e){return i("get_unified_ads_performance",e)}async function s(e){return i("get_avito_positions_analysis",e)}async function c(e){return i("get_geo_profitability_analysis",e)}async function a(e){return i("get_optimization_recommendations",e)}o.d(t,{MI:function(){return r},Q6:function(){return s},Rn:function(){return l},Ue:function(){return d},WW:function(){return i},jf:function(){return a},xL:function(){return c}})}},function(e){e.O(0,[971,23,744],function(){return e(e.s=525)}),_N_E=e.O()}]);