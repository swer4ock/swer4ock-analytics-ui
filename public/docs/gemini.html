<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ö–∞—Ä—Ç–∞ –°–∏—Å—Ç–µ–º—ã v2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8f9fa; color: #212529; }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        .chart-container { position: relative; width: 100%; max-width: 900px; margin-left: auto; margin-right: auto; height: 350px; max-height: 400px; }
        .ai-chart-container { position: relative; width: 100%; max-width: 500px; margin-left: auto; margin-right: auto; height: 400px; max-height: 450px; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .nav-item.active { background-color: #e0e7ff; color: #4f46e5; font-weight: 600; }
        .schema-card, .ai-card { transition: all 0.2s ease-in-out; }
        .schema-card:hover, .ai-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
    </style>
</head>
<body class="antialiased">
    <div class="flex flex-col md:flex-row min-h-screen">
        <nav class="w-full md:w-72 bg-white border-r border-gray-200 p-4 shrink-0">
            <h2 class="text-xl font-bold mb-6 text-gray-800">üè¢ –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –Æ–Ω–∏—Ç—ã</h2>
            <ul id="department-nav" class="space-y-2"></ul>
        </nav>

        <main class="flex-1 p-4 md:p-8 overflow-y-auto">
            <header class="mb-8">
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ö–∞—Ä—Ç–∞ –°–∏—Å—Ç–µ–º—ã</h1>
                <p class="text-gray-600 mt-2">–ï–¥–∏–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è AI-–∞–≥–µ–Ω—Ç–æ–≤ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –í—ã–±–µ—Ä–∏—Ç–µ —é–Ω–∏—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–π –∏ —Å–≤—è–∑–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏.</p>
            </header>
            
            <section id="overview-section" class="mb-8">
                 <h2 class="text-2xl font-bold text-gray-800 mb-4">–û–±–∑–æ—Ä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –î–∞–Ω–Ω—ã—Ö</h2>
                 <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <p class="text-gray-600 mb-4">–ù–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ –ø–æ–∫–∞–∑–∞–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–±–ª–∏—Ü –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–π —Å—Ö–µ–º–µ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –¥–∞–µ—Ç –æ–±—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –º–∞—Å—à—Ç–∞–±–µ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π —Å–∏—Å—Ç–µ–º—ã. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —é–Ω–∏—Ç–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∏–º —Å—Ö–µ–º—ã –±—É–¥—É—Ç –ø–æ–¥—Å–≤–µ—á–µ–Ω—ã.</p>
                    <div class="chart-container">
                        <canvas id="schemaChart"></canvas>
                    </div>
                </div>
            </section>

            <section id="content-display"></section>
        </main>
    </div>

<script>
const dbData = {
    departments: [
        { id: 'ai', name: 'ü§ñ –¶–ï–ù–¢–† –£–ü–†–ê–í–õ–ï–ù–ò–Ø AI (Vertex AI)', description: '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —è–¥—Ä–æ –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏, –æ–±—É—á–µ–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è AI-–∞–≥–µ–Ω—Ç–æ–≤. –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å–æ –≤—Å–µ–º–∏ –æ—Ç–¥–µ–ª–∞–º–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.', relatedSchemas: ['analytics', 'auth', 'core', 'marketplace', 'public', 'sales', 'storage', 'extensions', 'geography', 'realtime', 'supabase_migrations', 'vault'] },
        { id: 'it', name: '1Ô∏è‚É£ –ò–¢-–û–¢–î–ï–õ', description: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: –ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞.', relatedSchemas: ['core', 'auth', 'extensions', 'storage', 'vault', 'supabase_migrations', 'realtime'] },
        { id: 'sales', name: '2Ô∏è‚É£ –û–¢–î–ï–õ –ü–†–û–î–ê–ñ (CRM/SALES)', description: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ —Å–¥–µ–ª–∫–∞–º–∏.', relatedSchemas: ['sales', 'core', 'public'] },
        { id: 'product', name: '3Ô∏è‚É£ –ü–†–û–î–£–ö–¢–û–í–´–ô –û–¢–î–ï–õ (–ö–ê–¢–ê–õ–û–ì)', description: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ –∑–∞–ø–∞—Å–∞–º–∏.', relatedSchemas: ['sales', 'core'] },
        { id: 'analytics', name: '4Ô∏è‚É£ –ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–ô –û–¢–î–ï–õ', description: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: –ë–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å.', relatedSchemas: ['analytics', 'public', 'sales'] },
        { id: 'integrations', name: '5Ô∏è‚É£ –û–¢–î–ï–õ –ò–ù–¢–ï–ì–†–ê–¶–ò–ô (MARKETPLACES)', description: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏.', relatedSchemas: ['marketplace', 'core', 'public'] },
        { id: 'finance', name: '6Ô∏è‚É£ –§–ò–ù–ê–ù–°–û–í–´–ô –û–¢–î–ï–õ', description: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—á–µ—Ç –∏ –∞–Ω–∞–ª–∏–∑.', relatedSchemas: ['public', 'sales', 'core'] }
    ],
    schemas: {
        analytics: { name: 'analytics - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞', tables: ['data_assets', 'data_requests', 'error_logs'], views: ['v_autobidder_dashboard', 'v_avito_performance_summary', 'v_bidder_ad_performance', 'v_bidder_city_performance', 'v_bidder_strategy_monitoring', 'v_bidder_summary', 'v_cities_near_kazan', 'v_data_requests_queue', 'v_error_dashboard', 'v_performance_near_kazan', 'v_price_trends', 'v_product_kpis', 'v_ready_assets', 'v_stock_turnover'] },
        auth: { name: 'auth - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è', tables: ['audit_log_entries', 'flow_state', 'identities', 'instances', 'mfa_amr_claims', 'mfa_challenges', 'mfa_factors', 'oauth_clients', 'one_time_tokens', 'refresh_tokens', 'saml_providers', 'saml_relay_states', 'schema_migrations', 'sessions', 'sso_domains', 'sso_providers', 'users'], views: [] },
        core: { name: 'core - –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã', tables: ['ads_platforms', 'agent_limits', 'ai_policies', 'business_rules', 'calendar_reference', 'change_reasons', 'cities', 'currencies', 'customer_types', 'customers', 'default_task_checks', 'financial_metrics', 'geography_cities', 'idempotency_keys', 'product_categories', 'quarantine', 'queues', 'task_checks'], views: ['v_ai_task_queue'] },
        marketplace: { name: 'marketplace - –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã', tables: ['marketplaces', 'mcp_configs', 'product_mappings', 'sync_logs', 'xlsx_imports'], views: [] },
        public: { name: 'public - –û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ', tables: ['ai_agent_instructions', 'ai_events', 'analytics_requests', 'avito_ad_statistics', 'avito_bidder_ads', 'avito_bidder_city_strategies', 'avito_bidder_metadata', 'avito_bidder_settings', 'avito_complete_bids_analysis', 'avito_current_bids', 'companies', 'contact_identities', 'contacts', 'database_documentation', 'deal_tasks', 'deals', 'doc_simple', 'finance_metrics', 'idea_pool', 'interactions', 'interactions_staging', 'project_files_documentation', 'teams', 'tenant_users', 'tenants', 'ws_artifacts', 'ws_checks', 'ws_runs', 'ws_tasks'], views: ['v_finance_by_client_month', 'v_finance_daily', 'v_marketing_efficiency_analysis', 'v_table_documentation', 'v_tasks_filtered'] },
        sales: { name: 'sales - –ü—Ä–æ–¥–∞–∂–∏ –∏ –°–∫–ª–∞–¥', tables: ['ads_metrics_daily', 'avito_file_manifest', 'avito_metrics_daily', 'avito_raw_metrics', 'price_history', 'product_meta', 'products', 'sales_items_daily', 'stock_history', 'stock_levels', 'warehouses'], views: ['v_ads_by_platform', 'v_ads_pulse', 'v_ads_romi', 'v_avito_analytics', 'v_avito_crm_pulse', 'v_low_stock', 'v_products_with_stock', 'v_romi_daily', 'v_stock_by_location'] },
        storage: { name: 'storage - –•—Ä–∞–Ω–∏–ª–∏—â–µ', tables: ['buckets', 'buckets_analytics', 'migrations', 'objects', 'prefixes', 's3_multipart_uploads', 's3_multipart_uploads_parts'], views: [] },
        extensions: { name: 'extensions - –†–∞—Å—à–∏—Ä–µ–Ω–∏—è', tables: ['spatial_ref_sys'], views: [] },
        geography: { name: 'geography - –ì–µ–æ–≥—Ä–∞—Ñ–∏—è', tables: ['city_coordinates'], views: [] },
        realtime: { name: 'realtime - Real-time', tables: ['messages', 'schema_migrations', 'subscription'], views: [] },
        supabase_migrations: { name: 'supabase_migrations - –ú–∏–≥—Ä–∞—Ü–∏–∏', tables: ['schema_migrations'], views: [] },
        vault: { name: 'vault - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', tables: ['secrets'], views: [] }
    }
};

let schemaChart = null;
let aiImpactChart = null;

document.addEventListener('DOMContentLoaded', () => {
    const navContainer = document.getElementById('department-nav');
    dbData.departments.forEach((dept, index) => {
        const li = document.createElement('li');
        li.innerHTML = `<a href="#" data-dept-id="${dept.id}" class="nav-item block px-4 py-2 rounded-md text-gray-700 hover:bg-gray-100">${dept.name}</a>`;
        navContainer.appendChild(li);
        if(index === 0) {
            const hr = document.createElement('hr');
            hr.className = "my-4";
            navContainer.appendChild(hr);
        }
    });

    navContainer.addEventListener('click', (e) => {
        e.preventDefault();
        const link = e.target.closest('a');
        if (link) {
            const deptId = link.dataset.deptId;
            renderDepartmentView(deptId);

            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            link.classList.add('active');
        }
    });
    
    document.getElementById('content-display').addEventListener('click', e => {
        const header = e.target.closest('.accordion-header');
        if (header) {
            const content = header.nextElementSibling;
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
                header.querySelector('span').textContent = '‚ñº';
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
                header.querySelector('span').textContent = '‚ñ≤';
            }
        }
    });
    
    renderSchemaChart();
    renderDepartmentView('ai');
    const aiLink = document.querySelector('.nav-item[data-dept-id="ai"]');
    if (aiLink) aiLink.classList.add('active');
});

function renderSchemaChart(highlightedSchemas = []) {
    const ctx = document.getElementById('schemaChart').getContext('2d');
    const schemaNames = Object.keys(dbData.schemas).map(key => dbData.schemas[key].name.split(' - ')[0]);
    const schemaData = Object.keys(dbData.schemas).map(key => dbData.schemas[key].tables.length + dbData.schemas[key].views.length);
    
    const backgroundColors = Object.keys(dbData.schemas).map(schema => highlightedSchemas.includes(schema) ? 'rgba(79, 70, 229, 0.7)' : 'rgba(209, 213, 219, 0.7)');
    const borderColors = Object.keys(dbData.schemas).map(schema => highlightedSchemas.includes(schema) ? 'rgba(79, 70, 229, 1)' : 'rgba(156, 163, 175, 1)');

    if (schemaChart) {
        schemaChart.data.datasets[0].backgroundColor = backgroundColors;
        schemaChart.data.datasets[0].borderColor = borderColors;
        schemaChart.update();
        return;
    }
    
    Chart.defaults.font.family = "'Inter', sans-serif";
    
    schemaChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: schemaNames,
            datasets: [{
                label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ (—Ç–∞–±–ª–∏—Ü + –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π)',
                data: schemaData,
                backgroundColor: backgroundColors,
                borderColor: borderColors,
                borderWidth: 1
            }]
        },
        options: {
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: { beginAtZero: true, ticks: { color: '#4b5563' }, grid: { color: '#e5e7eb' } },
                y: { ticks: { color: '#4b5563' }, grid: { display: false } }
            },
            plugins: {
                legend: { display: false },
                tooltip: { backgroundColor: '#1f2937', titleFont: { size: 14, weight: 'bold' }, bodyFont: { size: 12 }, padding: 10, cornerRadius: 4 }
            }
        }
    });
}

function renderAiImpactChart() {
    if (aiImpactChart) {
        aiImpactChart.destroy();
    }
    const ctx = document.getElementById('aiImpactChart').getContext('2d');
    const labels = ['sales', 'analytics', 'marketplace', 'core', 'public', 'storage'];
    const data = [10, 9, 8, 7, 8, 5]; 
    
    aiImpactChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: labels,
            datasets: [{
                label: '–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –≤–ª–∏—è–Ω–∏—è AI',
                data: data,
                fill: true,
                backgroundColor: 'rgba(79, 70, 229, 0.2)',
                borderColor: 'rgb(79, 70, 229)',
                pointBackgroundColor: 'rgb(79, 70, 229)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgb(79, 70, 229)'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            elements: { line: { borderWidth: 2 } },
            scales: { r: { angleLines: { color: '#e5e7eb' }, grid: { color: '#e5e7eb' }, pointLabels: { font: { size: 14, weight: '500' }, color: '#374151' }, ticks: { backdropColor: 'rgba(255, 255, 255, 0.75)', color: '#4b5563' }, suggestedMin: 0, suggestedMax: 10 } },
            plugins: { legend: { display: false } }
        }
    });
}

function renderDepartmentView(deptId) {
    const department = dbData.departments.find(d => d.id === deptId);
    if (!department) return;

    const contentContainer = document.getElementById('content-display');
    
    if (deptId === 'ai') {
        contentContainer.innerHTML = `
            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-8">
                <h2 class="text-2xl font-bold text-gray-800">${department.name}</h2>
                <p class="mt-2 text-gray-600">${department.description}</p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4">–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã Vertex AI</h3>
                    <div class="space-y-4">
                        <div class="ai-card bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-bold text-lg text-indigo-700">üß† –ú–æ–∑–≥ –°–∏—Å—Ç–µ–º—ã (Gemini 1.5 Pro)</h4>
                            <p class="text-gray-600 text-sm mt-1">–í—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É: –∞–Ω–∞–ª–∏–∑, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SQL, –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞. –Ø–≤–ª—è–µ—Ç—Å—è —è–¥—Ä–æ–º –¥–ª—è –≤—Å–µ—Ö AI-–∞–≥–µ–Ω—Ç–æ–≤.</p>
                        </div>
                        <div class="ai-card bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-bold text-lg text-indigo-700">üìö –ë–∞–∑–∞ –ó–Ω–∞–Ω–∏–π (Grounding & Vector Search)</h4>
                            <p class="text-gray-600 text-sm mt-1">–û–±—É—á–∞–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ –≤–∞—à–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (—Å—Ö–µ–º—ã <strong>public, core</strong>), –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤.</p>
                        </div>
                        <div class="ai-card bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-bold text-lg text-indigo-700">üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ê–≥–µ–Ω—Ç–æ–≤ (Agent Builder)</h4>
                            <p class="text-gray-600 text-sm mt-1">–ü–æ–∑–≤–æ–ª—è–µ—Ç –∞–≥–µ–Ω—Ç–∞–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–π—Å—Ç–≤–∏—è: –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ <strong>sales</strong>, —Å—Ç—Ä–æ–∏—Ç—å –æ—Ç—á–µ—Ç—ã –ø–æ <strong>analytics</strong>, —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–¥–∞—á–∞–º–∏ –≤ <strong>ws_tasks</strong>.</p>
                        </div>
                         <div class="ai-card bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-bold text-lg text-indigo-700">‚öôÔ∏è –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä (Vertex AI Pipelines)</h4>
                            <p class="text-gray-600 text-sm mt-1">–£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª–æ–∂–Ω—ã–º–∏, –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã.</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                     <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">–ö–∞—Ä—Ç–∞ –í–ª–∏—è–Ω–∏—è AI –Ω–∞ –î–∞–Ω–Ω—ã–µ</h3>
                     <p class="text-gray-600 mb-4 text-sm text-center">–î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –≥–ª—É–±–∏–Ω—ã –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å—Ö–µ–º –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ AI-–∞–≥–µ–Ω—Ç–æ–≤.</p>
                    <div class="ai-chart-container">
                        <canvas id="aiImpactChart"></canvas>
                    </div>
                </div>
            </div>
        `;
        renderAiImpactChart();
        renderSchemaChart(department.relatedSchemas);
    } else {
        let schemaHtml = '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">';
        department.relatedSchemas.forEach(schemaId => {
            const schema = dbData.schemas[schemaId];
            if(schema) {
                schemaHtml += `
                <div class="schema-card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <div class="accordion-header cursor-pointer flex justify-between items-center">
                        <h4 class="text-lg font-semibold text-indigo-700">${schema.name}</h4>
                        <span class="text-indigo-700">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <h5 class="font-semibold text-gray-700 mb-2">–¢–∞–±–ª–∏—Ü—ã (${schema.tables.length}):</h5>
                            <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
                                ${schema.tables.map(t => `<li>${t}</li>`).join('') || '<li>–ù–µ—Ç —Ç–∞–±–ª–∏—Ü</li>'}
                            </ul>
                            <h5 class="font-semibold text-gray-700 mt-4 mb-2">–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (${schema.views.length}):</h5>
                            <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
                                ${schema.views.map(v => `<li>${v}</li>`).join('') || '<li>–ù–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π</li>'}
                            </ul>
                        </div>
                    </div>
                </div>`;
            }
        });
        schemaHtml += '</div>';

        const html = `
            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-8">
                <h2 class="text-2xl font-bold text-gray-800">${department.name}</h2>
                <p class="mt-2 text-gray-600">${department.description}</p>
            </div>
            <div>
                <h3 class="text-xl font-bold text-gray-800 mb-4">–ö–ª—é—á–µ–≤—ã–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö</h3>
                 <p class="text-gray-600 mb-6">–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ö–µ–º—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–π –æ—Ç–¥–µ–ª. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π.</p>
                ${schemaHtml}
            </div>
        `;
        contentContainer.innerHTML = html;
        if (aiImpactChart) { aiImpactChart.destroy(); aiImpactChart = null; }
        renderSchemaChart(department.relatedSchemas);
    }
    document.getElementById('overview-section').scrollIntoView({ behavior: 'smooth' });
}
</script>
</body>
</html>
